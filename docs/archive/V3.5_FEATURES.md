# PurpleSploit v3.5 - New Features

## Overview
Version 3.5 adds two powerful new features to streamline your workflow:
1. **Wordlist Manager** - Organize and manage wordlists by attack type
2. **Module Creator** - Generate new modules from templates

---

## 1. Wordlist Manager

### Description
The Wordlist Manager allows you to organize and manage wordlists by category, similar to how targets and credentials are managed. Each category can have multiple wordlists, and you can set a preferred wordlist for each attack type.

### Categories
- `web_dir` - Web directory/file fuzzing (feroxbuster, dirbuster, etc.)
- `dns_vhost` - DNS/VHost fuzzing (ffuf, gobuster dns)
- `username` - Username enumeration
- `password` - Password attacks
- `subdomain` - Subdomain enumeration
- `parameter` - Parameter fuzzing
- `api` - API endpoint discovery
- `general` - General-purpose wordlists

### Commands

#### List all wordlists
```bash
wordlists list
```

#### Add a wordlist to a category
```bash
wordlists add web_dir /usr/share/wordlists/dirb/common.txt "Common Dirs"
wordlists add password /usr/share/wordlists/rockyou.txt "RockYou"
wordlists add subdomain /opt/SecLists/Discovery/DNS/subdomains-top1million.txt
```

#### Select a wordlist interactively (with fzf)
```bash
wordlists select web_dir
```

#### Set current wordlist for a category
```bash
wordlists set web_dir 0                    # Set by index
wordlists set password rockyou.txt         # Set by name
```

#### Remove a wordlist
```bash
wordlists remove web_dir /path/to/wordlist.txt
```

### Example Workflow
```bash
# Add commonly used wordlists
wordlists add web_dir /usr/share/wordlists/dirb/common.txt "Common"
wordlists add web_dir /usr/share/wordlists/dirb/big.txt "Big"
wordlists add password /usr/share/wordlists/rockyou.txt "RockYou"

# List what you have
wordlists list

# Select preferred wordlist for web directory fuzzing
wordlists select web_dir

# Your selected wordlist is now marked with [✓]
# Other modules can reference: framework.session.wordlists.get_current("web_dir")
```

### Integration
- Wordlists persist across sessions (saved in session export)
- Modules can access current wordlist: `self.framework.session.wordlists.get_current("web_dir")`
- Interactive selection with fzf support (falls back to simple selection if fzf not available)

---

## 2. Module Creator

### Description
The Module Creator is an interactive tool that helps you quickly scaffold new PurpleSploit modules from templates. Perfect for adding simple command-based modules without writing boilerplate code.

### Usage
```bash
# Load the module creator
use utility/module_creator

# Run to see available templates
run
```

### Available Templates

#### 1. Simple Command Module
**Use case:** Run a single command with variable substitution
**Example:** Mount an NFS share, run a quick tool

**Prompts:**
- Module name (e.g., "NFS Mount")
- Category (web/network/recon/post)
- Description
- Command template (e.g., `mount -t nfs {RHOST}:/share /mnt`)
- Required options (RHOST, RPORT, URL)

**Generated module features:**
- Automatic option validation
- Variable substitution in commands
- Standard PurpleSploit module structure

#### 2. External Tool Wrapper
**Use case:** Wrap an external CLI tool
**Example:** Create a wrapper for nikto, nuclei, or custom tools

**Prompts:**
- Module name (e.g., "Nikto Scanner")
- Tool command name (e.g., "nikto")
- Category
- Description

**Generated module features:**
- Tool availability checking
- Command building
- Timeout handling
- Standard ExternalToolModule inheritance

#### 3. Multi-Operation Module
**Use case:** Module with multiple sub-operations (like feroxbuster)
**Example:** Scanner with different scan types

**Prompts:**
- Module name
- Category
- Description
- Operations (name, description, command) - add multiple

**Generated module features:**
- Operation selection menu
- Individual operation handlers
- Standard module structure with get_operations()

### Example: Creating an NFS Mount Module

```bash
# In PurpleSploit console
use utility/module_creator
run

# Select "1. Simple Command Module"
# Fill in prompts:
Module name: NFS Mount
Category: post
Description: Mount NFS shares
Command template: mount -t nfs {RHOST}:{SHARE} /mnt/nfs
Needs RHOST? y
Needs RPORT? n

# Module created at: python/purplesploit/modules/post/nfs_mount.py
# Restart PurpleSploit or reload
# Then: use post/nfs_mount
```

### Example: Creating a Tool Wrapper

```bash
use utility/module_creator
run

# Select "2. External Tool Wrapper"
# Fill in prompts:
Module name: Nuclei Scanner
Tool command: nuclei
Category: web
Description: Nuclei vulnerability scanner

# Module created!
# Customize the build_command() method to match nuclei's syntax
```

### Generated Module Structure

All generated modules include:
- Proper PurpleSploit module inheritance
- Metadata (name, description, author, category)
- Option definitions with validation
- Command execution
- Error handling
- PEP 8 compliant code

### Customization

After generation, you can customize:
- Add more options in `_init_options()`
- Modify `build_command()` for complex command building
- Add output parsing with `parse_output()`
- Add additional operations for multi-operation modules

---

## Testing

Both features include automated tests:

```bash
python3 test_v3.5_features.py
```

Tests verify:
- WordlistManager: add, remove, list, select, export, import
- Module Creator: loading, operations, template generation

---

## Integration with Existing Features

### Wordlists + Modules
Modules can automatically use selected wordlists:

```python
# In your module
wordlist = self.framework.session.wordlists.get_current("web_dir")
if wordlist:
    path = wordlist['path']
    command = f"feroxbuster -u {url} -w {path}"
```

### Module Creator + Your Workflow
1. Create module template
2. Customize the generated code
3. Test with: `use <category>/<module_name>`
4. Share or integrate into your workflow

---

## Files Modified/Added

### Core Changes
- `python/purplesploit/core/session.py`: Added `WordlistManager` class
- `python/purplesploit/ui/commands.py`: Added `cmd_wordlists()` and help text
- `python/purplesploit/ui/interactive.py`: Added `select_wordlist()` method

### New Modules
- `python/purplesploit/modules/utility/__init__.py`: New utility category
- `python/purplesploit/modules/utility/module_creator.py`: Module creator implementation

### Tests
- `test_v3.5_features.py`: Automated tests for both features

---

## Future Enhancements

Potential future additions:
- Auto-detect and suggest common wordlist locations
- Wordlist statistics (line count, size)
- Module creator templates for more complex scenarios
- Module generator from API documentation
- Integration with SecLists and other wordlist repositories

---

## Version Info

- **Version:** 3.5
- **Branch:** `claude/v3.5-wordlist-module-creator-011CUvqRirLZXFwNGrAoGRfk`
- **Commit:** All features tested and working ✓

## Questions?

Both features follow the same design patterns as existing PurpleSploit features (targets, creds, modules) for consistency and ease of use.
